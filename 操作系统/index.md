# 操作系统


<!--more-->

# 操作系统

## 进程管理

### 1. 进程和线程的区别

- 调度: 进程是资源管理的基本单位，线程是程序执行的基本单位
- 切换: 线程上下文切换比进程上下文切换要快得多
- 拥有资源:进程是拥有资源的一个独立单位，线程不拥有系统资源，但是可以访问隶属于进程的资源。
- 系统开销:创建或撤销进程时，系统都要为之分配或回收系统资源，如内存空间，I/O 设备等，OS所付出的 开销显著大于在创建(只有栈的开销)或撤销线程时的开销，进程切换的开销也远大于线程切换的开销。



### 2. 进程和线程的切换流程

- 进程切换:

  切换页表以使用新的地址空间，一旦去切换上下文，处理器中所有已经缓存的内存地址一瞬间都作废了。

  切换内核栈和硬件上下文。

  

- 线程切换

​				线程切换时因为其共享所在进程的虚拟地址空间的, 所以不需要切换地址空间,只需要切换内核栈和上下文

### 3.为什么虚拟空间的切换特别耗时?

​		进程都有自己的虚拟地址空间，把虚拟地址转换为物理地址需要查找页表，页表查找是一个很慢的过程，因此通常使用 Cache 来缓存常用的地址映射，这样可以加速页表查找，这个 Cache 就是 TLB(translation Lookaside Buffer， TLB本质上就是一个 Cache，是用来加速页表查找的)

​		显然每个进程都有自己的页表，那么当进程切换后页表也要进行切换，页表切换后 TLB就失效了，Cache 失效导致命 中率降低，那么虚拟地址转换为物理地址就会变慢，表现出来的就是程序运行会变慢

### 4.进程通信方式

- 管道 (速度慢，容量有限;)

> 管道可以分为两类:匿名管道和命名管道。匿名管道是单向的，只能在有亲缘关系的进程间通信;命名管道以磁盘文件的方式存在，可以实现本机任意两个进程通信。

- 信号

> 常用信号: 
>
> 1. SIGHUP: 用户从终端注销，所有已启动进程都将收到该进程。系统缺省状态下对该信号的处理是终止进程。
> 2. SIGINT: 程序终止信号。程序运行过程中，按 Ctrl+C 键将产生该信号。
> 3. SIGQUIT:程序退出信号。程序运行过程中，按 Ctrl+\键将产生该信号
> 4. SIGBUS和 SIGSEGV:进程 访问非法地址。
> 5. **SIGKILL**:用户终止进程执行信号。shell 下执行 kill -9 发送该信号。

- 信号量: 信号量是一个计数器，可以用来控制多个进程对共享资源的访问。它常作为一种锁机制，防止某进程 正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同一进程内不同线程之间的同步手 段。(不能传递复杂消息，只能用来同步;)
- 消息队列。 (容量受到系统限制，且要注意第一次读的时候，要考虑上一次没有读完数据的问题;)
- 共享内存:共享内存就是映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都 可以访问。共享内存是最快的 IPC 方式(能够很容易控制容量，速度快，但要保持同步)
- Socket: 不同机器间的进程间通信



### 5. 进程间同步的方式

- 临界区

  通过对多线程的串行化来访问公共资源或一段代码，速度快，适合控制数据访问。

  优点: 保证在某一时刻只有一个线程能访问数据的简便办法

  缺点: 

- 互斥量





## 内存管理










